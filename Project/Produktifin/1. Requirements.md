## 1. **Authentication & User Management**
### Core Features
- Users can:
    - **Sign up** using email & password
    - **Sign in / Sign out**
    - **(Optional)** Social login (Google, GitHub) — Phase 2
- **Password recovery** (via email link)
- **Session persistence**:
    - Using **JWT** for REST microservices
    - Using **HTTP-only cookies** for SSR (Next.js)
- **Role differentiation**:
    - **Guest:** limited, no data persistence
    - **User:** full persistence and scheduling
### Technical Notes
- Authentication handled by a dedicated `auth-service` (Go)
- JWT includes access + refresh tokens
- Passwords hashed using bcrypt or Argon2
- Token verification via API gateway middleware (Traefik/Kong)

---

## 2. **Pomodoro Core**
### Core Features
- Users (guest or logged-in) can:
    - Start a **Pomodoro session**
    - Configure durations:
        - Pomodoro time
        - Short break time
        - Long break time
        - Long break interval (e.g. after every 4 Pomodoros)
    - Attach a **to-do list** (CRUD per task)
    - Pause or finish a session
### Session Tracking
- System tracks:
    - Number of Pomodoros completed
    - Number of short/long breaks taken
    - Total focused time
- Sessions can be:
    - **Running**
    - **Paused** (data saved for resume)
    - **Finished** (archived in history)
### Persistence Rules
- **Guest**: session data stored in browser local storage or Redis (temporary)
- **User**: data stored permanently in PostgreSQL
### Technical Notes
- Auto-save progress on state change (every few seconds)
- WebSocket or SSE (Server-Sent Events) used for real-time timer sync
- To-do list linked by `session_id`
- Timer logic handled client-side with periodic sync to backend

---

## 3. **History & Session Management**

### Core Features
- **Guest users**:
    - Can use Pomodoro and to-do features
    - No saved history (lost on reload/inactivity)
- **Logged-in users**:
    - Can **save**, **discard**, or **resume** a session
    - View all previous sessions (with pagination)
    - Delete specific sessions
    - Resume paused sessions
### Session Data Model
Each history record includes:
- Session ID
- User ID
- Date/time of session
- Pomodoro count, durations, breaks
- To-do list snapshot
- Session status: `finished`, `paused`, `planned`
- Total focused time
### Technical Notes
- Use `history-service` (Go) connected to PostgreSQL
- Redis optional for caching recent sessions
- Auto-deletion of paused sessions older than X days (configurable)

---

## 4. **Calendar & Planning**

### Core Features
- Users can:
    - Plan Pomodoro sessions (set date & time)
    - View sessions in **calendar view**:
        - Planned
        - Paused
        - Finished
    - Click a session card to:
        - Start (if planned)
        - Resume (if paused)
- Sessions sync automatically with Pomodoro history
### Optional Enhancements (Phase 2)
- Reminders (email, browser notification)
- Google Calendar sync
- Daily/weekly productivity summary
### Technical Notes
- Calendar handled by `calendar-service`
- Frontend uses React-based library (e.g., FullCalendar or React Big Calendar)
- Backend scheduling via Redis queue + cron job
---

## 5. **Settings & Configuration**
### Core Features
- Users can:
    - Set default Pomodoro configuration (durations, intervals)
    - Choose preferred theme (Dark / Light)
    - Enable or disable sound notifications
### Technical Notes
- Settings stored in user profile table (`user_settings`)
- Guest settings saved in local storage

---

## 6. **Analytics & Reports** _(Phase 2 – Post-MVP)_
- Dashboard showing:
    - Total Pomodoros completed
    - Total focused hours
    - Streaks (days with at least 1 completed session)
    - Task completion rate
- Export reports (CSV/JSON)

---

## 7. **Architecture Overview**

| Service                             | Responsibility                   | Tech Stack                    |
| ----------------------------------- | -------------------------------- | ----------------------------- |
| `auth-service`                      | User registration, login, tokens | Go (Gin / Echo), PostgreSQL   |
| `pomodoro-service`                  | Timer logic, session CRUD        | Go, Redis (cache), PostgreSQL |
| `history-service`                   | Store session logs               | Go, PostgreSQL                |
| `calendar-service`                  | Scheduling & reminders           | Go, Redis Queue, Cron         |
| `gateway-service`                   | API gateway & routing            | Traefik / Nginx               |
| `frontend`                          | Next.js app (SSR + SPA)          | Next.js 15, Tailwind, Zustand |
| `notification-service` _(optional)_ | Email/push reminders             | Go worker, SMTP or WebPush    |

---

## 8. **Data Storage Design**
### PostgreSQL Tables
- `users`
- `sessions`
- `tasks`
- `session_history`
- `user_settings`
- `calendar_events`
### Redis Keys
- `guest_session:{id}`
- `user_active_sessions:{user_id}`
- `notification_queue`

---

## 9. **Infrastructure & DevOps**
- **Containerization:** Docker + Docker Compose
- **Orchestration:** optional Kubernetes for scaling
- **CI/CD:** GitHub Actions → build + test + deploy
- **Environment variables:** managed via `.env` per service
- **Caching:** Redis (optional but recommended)
- **Monitoring:** Prometheus + Grafana (Phase 2)
