Base URL (through API Gateway):

```
https://api.produktifin.com/v1/
```

---

## üîê 1. Auth Service

### Base Path

```
/auth
```

### Endpoints

#### **POST /auth/signup**

Create a new user account.  
**Request**

```json
{
  "email": "user@example.com",
  "password": "mypassword",
  "name": "John Doe"
}
```

**Response 201**

```json
{
  "id": "u_01",
  "email": "user@example.com",
  "name": "John Doe",
  "token": "jwt_access_token",
  "refresh_token": "jwt_refresh_token"
}
```

---

#### **POST /auth/login**

Authenticate an existing user.  
**Request**

```json
{
  "email": "user@example.com",
  "password": "mypassword"
}
```

**Response 200**

```json
{
  "token": "jwt_access_token",
  "refresh_token": "jwt_refresh_token"
}
```

---

#### **POST /auth/refresh**

Refresh an expired access token.  
**Request**

```json
{
  "refresh_token": "jwt_refresh_token"
}
```

**Response 200**

```json
{
  "token": "new_access_token"
}
```

---

#### **POST /auth/logout**

Invalidate refresh token (optional for stateless JWTs).

---

#### **POST /auth/password/forgot**

Send password reset link via email.

**Request**

```json
{
  "email": "user@example.com"
}
```

---

#### **POST /auth/password/reset**

Reset user password using reset token.

**Request**

```json
{
  "token": "reset_token",
  "new_password": "newStrongPass123"
}
```

---

## ‚è± 2. Pomodoro Service

### Base Path

```
/pomodoro
```

---

#### **POST /pomodoro/session**

Create a new Pomodoro session.

**Request**

```json
{
  "duration_pomodoro": 25,
  "duration_short_break": 5,
  "duration_long_break": 15,
  "long_break_interval": 4,
  "tasks": [
    { "title": "Write API Spec", "is_done": false },
    { "title": "Test endpoints", "is_done": false }
  ]
}
```

**Response 201**

```json
{
  "session_id": "sess_01",
  "status": "running",
  "start_time": "2025-10-05T14:00:00Z"
}
```

---

#### **GET /pomodoro/session/{id}**

Retrieve session details (running, paused, or finished).

**Response 200**

```json
{
  "id": "sess_01",
  "status": "paused",
  "pomodoro_count": 3,
  "breaks_taken": 1,
  "tasks": [
    { "id": "t1", "title": "Write API Spec", "is_done": true }
  ]
}
```

---

#### **PATCH /pomodoro/session/{id}/pause**

Pause a running session.

**Response 200**

```json
{ "status": "paused", "progress_time": 1200 }
```

---

#### **PATCH /pomodoro/session/{id}/resume**

Resume a paused session.

**Response 200**

```json
{ "status": "running" }
```

---

#### **PATCH /pomodoro/session/{id}/finish**

Mark session as finished.

**Response 200**

```json
{ "status": "finished" }
```

---

#### **POST /pomodoro/task**

Add a new task to an active session.

**Request**

```json
{ "session_id": "sess_01", "title": "New Task" }
```

**Response 201**

```json
{ "task_id": "task_03", "title": "New Task", "is_done": false }
```

---

#### **PATCH /pomodoro/task/{id}**

Update a task (e.g. mark as done).

**Request**

```json
{ "is_done": true }
```

---

#### **DELETE /pomodoro/task/{id}**

Delete a task from a session.

---

## üïì 3. History Service

### Base Path

```
/history
```

---

#### **GET /history**

List all saved sessions for the authenticated user.

**Query Params**

- `status=finished|paused|planned`
    
- `limit=10`
    
- `offset=0`
    

**Response**

```json
{
  "sessions": [
    {
      "id": "sess_01",
      "date": "2025-10-05T14:00:00Z",
      "pomodoros": 4,
      "status": "finished",
      "duration_total": 100
    }
  ]
}
```

---

#### **GET /history/{id}**

Get detailed data of a past session.

**Response**

```json
{
  "id": "sess_01",
  "tasks": [
    { "title": "Write Docs", "is_done": true }
  ],
  "pomodoro_count": 4,
  "total_time": 100,
  "created_at": "2025-10-05T14:00:00Z"
}
```

---

#### **DELETE /history/{id}**

Delete a session record.

---

#### **PATCH /history/{id}/resume**

Resume a previously paused session.

**Response**

```json
{
  "new_session_id": "sess_09",
  "status": "running"
}
```

---

## üìÖ 4. Calendar Service

### Base Path

```
/calendar
```

---

#### **POST /calendar/events**

Schedule a planned Pomodoro session.

**Request**

```json
{
  "title": "Morning Focus",
  "date": "2025-10-06T08:00:00Z",
  "duration": 25,
  "repeat": "none"
}
```

**Response**

```json
{
  "event_id": "cal_01",
  "status": "planned"
}
```

---

#### **GET /calendar/events**

Get all calendar events for the current month.

**Query Params**

- `start=2025-10-01`
    
- `end=2025-10-31`
    

**Response**

```json
{
  "events": [
    { "id": "cal_01", "title": "Morning Focus", "status": "planned" }
  ]
}
```

---

#### **GET /calendar/events/{id}**

View details of a specific planned session.

---

#### **PATCH /calendar/events/{id}**

Update a planned session (e.g. reschedule).

---

#### **DELETE /calendar/events/{id}**

Delete a planned session.

---

#### **POST /calendar/events/{id}/start**

Start a planned session ‚Üí creates a new active Pomodoro session.

**Response**

```json
{
  "session_id": "sess_10",
  "status": "running"
}
```

---

## ‚öôÔ∏è 5. Common Responses

### 401 Unauthorized

```json
{ "error": "Invalid or expired token" }
```

### 400 Bad Request

```json
{ "error": "Missing required field: email" }
```

### 404 Not Found

```json
{ "error": "Session not found" }
```

---

## üß∞ 6. Authentication Header (for all protected routes)

```
Authorization: Bearer <jwt_access_token>
```

---

## üß± 7. Service Communication

| Source Service                  | Destination      | Purpose                |
| ------------------------------- | ---------------- | ---------------------- |
| Auth Service                    | Gateway          | Verify token validity  |
| Pomodoro Service                | History Service  | Log finished sessions  |
| Calendar Service                | Pomodoro Service | Start planned sessions |
| Notification Service _(future)_ | Calendar Service | Send reminders         |

---

## üß© 8. Example Integration Flow

1. **User logs in** ‚Üí `/auth/login` ‚Üí receives JWT
    
2. **Starts session** ‚Üí `/pomodoro/session`
    
3. **Pauses session** ‚Üí `/pomodoro/session/:id/pause`
    
4. **Resumes later** ‚Üí `/history/:id/resume`
    
5. **Plans new session** ‚Üí `/calendar/events`
    

---
